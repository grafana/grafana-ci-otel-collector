# Refer to https://raw.githubusercontent.com/open-telemetry/opentelemetry-collector-contrib/main/cmd/mdatagen/metadata-schema.yaml
# for the full schema
type: dronereceiver

sem_conv_version: 1.9.0

status:
  class: receiver
  stability:
    development: [logs, traces, metrics]
  warnings:
    - Any additional information that should be brought to the consumer's attention

resource_attributes:

attributes:
  build.status:
    description: Build status
    # TODO: double check if the following list is correct
    enum:
      [
        pending,
        running,
        success,
        failure,
        skipped,
        error,
        killed,
        blocked,
        paused,
        waiting_on_dependencies,
        unknown,
      ]
    type: string

metrics:
  builds_number:
    enabled: true
    description: Number of builds.
    extended_documentation:
      Currently there's no way to differentiate between restarted builds and manually triggered builds.
      This means builds started manually (i.e. via Drone UI or via APis) will count towards this metric
      should they run against a branch for which a build has already been executed.
    unit: 1
    sum:
      value_type: int
      monotonic: false
      aggregation: cumulative
    attributes: [build.status]
  restarts_total:
    enabled: true
    description: Total number build restarts.
    unit: 1
    sum:
      value_type: int
      monotonic: true
      aggregation: cumulative
